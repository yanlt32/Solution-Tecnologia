<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ITIL Administrador | Solution Tecnologia</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-light: #8906E6; /* Roxo */
      --primary-dark: #050DEB; /* Azul */
      --secondary-light: #FF00E2; /* Rosa */
      --accent-light: #FF9F0A;
      --success-light: #30D158;
      --danger-light: #FF453A;
      --warning-light: #FF9F0A;
      --text-light: #1C1C1E;
      --text-secondary-light: #636366;
      --background-light: #F5F5F7;
      --surface-light: #FFFFFF;
      --border-light: #E5E5EA;

      --primary-dark-dark: #FF00E2; /* Rosa */
      --secondary-dark: #050DEB; /* Azul */
      --accent-dark: #FF9F0A;
      --success-dark: #30D158;
      --danger-dark: #FF453A;
      --warning-dark: #FF9F0A;
      --text-dark: #FFFFFF;
      --text-secondary-dark: #A1A1A6;
      --background-dark: #121212;
      --surface-dark: #1E1E1E;
      --border-dark: #2C2C2E;

      --border-radius: 12px;
      --sidebar-width: 240px;
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', sans-serif;
    }

    body {
      background-color: var(--background-dark);
      color: var(--text-dark);
      line-height: 1.6;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      transition: background-color 0.3s ease;
    }

    body[data-theme="light"] {
      background-color: var(--background-light);
      color: var(--text-light);
    }

    .container {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: var(--sidebar-width);
      background: var(--surface-dark);
      color: var(--text-dark);
      padding: 0;
      transition: var(--transition);
      border-right: 1px solid var(--border-dark);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
    }

    body[data-theme="light"] .sidebar {
      background: var(--surface-light);
      color: var(--text-light);
      border-right: 1px solid var(--border-light);
    }

    .sidebar-header {
      padding: 24px 20px;
      border-bottom: 1px solid var(--border-dark);
      text-align: center;
    }

    body[data-theme="light"] .sidebar-header {
      border-bottom: 1px solid var(--border-light);
    }

    .sidebar-header img.logo {
      width: 80px;
      height: auto;
      margin-bottom: 8px;
    }

    .sidebar-header h2 {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-size: 20px;
      font-weight: 700;
      color: var(--text-dark);
    }

    body[data-theme="light"] .sidebar-header h2 {
      color: var(--text-light);
    }

    .sidebar-header h2 i {
      color: var(--primary-dark);
      background: rgba(137, 6, 230, 0.2);
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body[data-theme="light"] .sidebar-header h2 i {
      color: var(--primary-light);
    }

    .user-info {
      padding: 20px;
      margin-bottom: 0;
      border-bottom: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .user-info {
      border-bottom: 1px solid var(--border-light);
    }

    .user-info p {
      margin-bottom: 6px;
      font-size: 14px;
      color: var(--text-secondary-dark);
    }

    body[data-theme="light"] .user-info p {
      color: var(--text-secondary-light);
    }

    .user-info .role-badge {
      display: inline-block;
      background: var(--primary-dark);
      color: var(--text-dark);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      margin-top: 6px;
    }

    body[data-theme="light"] .user-info .role-badge {
      background: var(--primary-light);
      color: var(--text-light);
    }

    .nav-menu {
      list-style: none;
      padding: 12px;
      flex-grow: 1;
    }

    .nav-item {
      margin-bottom: 4px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      padding: 12px 14px;
      color: var(--text-secondary-dark);
      text-decoration: none;
      transition: var(--transition);
      gap: 10px;
      border-radius: var(--border-radius);
      font-size: 14px;
      font-weight: 500;
      position: relative;
    }

    body[data-theme="light"] .nav-link {
      color: var(--text-secondary-light);
    }

    .nav-link:hover {
      background: rgba(137, 6, 230, 0.1);
      color: var(--primary-dark);
    }

    body[data-theme="light"] .nav-link:hover {
      color: var(--primary-light);
    }

    .nav-link.active {
      background: rgba(137, 6, 230, 0.2);
      color: var(--primary-dark);
      font-weight: 600;
    }

    body[data-theme="light"] .nav-link.active {
      color: var(--primary-light);
    }

    .nav-link.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      height: 18px;
      width: 4px;
      background: var(--primary-dark);
      border-radius: 0 2px 2px 0;
    }

    body[data-theme="light"] .nav-link.active::before {
      background: var(--primary-light);
    }

    .nav-link i {
      width: 18px;
      text-align: center;
      font-size: 16px;
    }

    .sidebar-footer {
      padding: 12px;
      border-top: 1px solid var(--border-dark);
      font-size: 11px;
      color: var(--text-secondary-dark);
      text-align: center;
    }

    body[data-theme="light"] .sidebar-footer {
      border-top: 1px solid var(--border-light);
      color: var(--text-secondary-light);
    }

    .main-content {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
      background: var(--background-dark);
    }

    body[data-theme="light"] .main-content {
      background: var(--background-light);
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .header {
      border-bottom: 1px solid var(--border-light);
    }

    .header h1 {
      color: var(--text-dark);
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.5px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    body[data-theme="light"] .header h1 {
      color: var(--text-light);
    }

    .header h1 i {
      color: var(--primary-dark);
    }

    .btn-group {
      display: flex;
      gap: 12px;
    }

    .back-btn, .logout-btn {
      background: var(--surface-dark);
      color: var(--text-dark);
      border: none;
      padding: 10px 16px;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
      text-decoration: none;
      font-weight: 500;
      font-size: 14px;
    }

    body[data-theme="light"] .back-btn {
      background: var(--surface-light);
      color: var(--text-light);
    }

    .back-btn:hover {
      background: var(--border-dark);
      transform: translateY(-2px);
    }

    body[data-theme="light"] .back-btn:hover {
      background: var(--border-light);
    }

    .logout-btn {
      background: var(--danger-light);
      box-shadow: 0 4px 12px rgba(255, 69, 58, 0.2);
    }

    .logout-btn:hover {
      background: #D70015;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255, 69, 58, 0.3);
    }

    .theme-toggle {
      background: var(--primary-dark);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      width: 40px;
      height: 40px;
    }

    body[data-theme="light"] .theme-toggle {
      background: var(--primary-light);
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border-dark);
      overflow-x: auto;
    }

    body[data-theme="light"] .tabs {
      border-bottom: 1px solid var(--border-light);
    }

    .tab {
      padding: 14px 24px;
      background: transparent;
      border: none;
      color: var(--text-secondary-dark);
      cursor: pointer;
      font-size: 15px;
      font-weight: 500;
      transition: var(--transition);
      position: relative;
      white-space: nowrap;
    }

    body[data-theme="light"] .tab {
      color: var(--text-secondary-light);
    }

    .tab:hover {
      color: var(--primary-dark);
    }

    body[data-theme="light"] .tab:hover {
      color: var(--primary-light);
    }

    .tab.active {
      color: var(--primary-dark);
      font-weight: 600;
    }

    body[data-theme="light"] .tab.active {
      color: var(--primary-light);
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--primary-dark);
      border-radius: 3px 3px 0 0;
    }

    body[data-theme="light"] .tab.active::after {
      background: var(--primary-light);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .stats-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: var(--surface-dark);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      gap: 14px;
      border: 1px solid var(--border-dark);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    body[data-theme="light"] .stat-card {
      background: var(--surface-light);
      border: 1px solid var(--border-light);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .stat-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--primary-dark);
    }

    body[data-theme="light"] .stat-card::after {
      background: var(--primary-light);
    }

    .stat-card:nth-child(2)::after { background: var(--success-light); }
    .stat-card:nth-child(3)::after { background: var(--warning-light); }
    .stat-card:nth-child(4)::after { background: var(--danger-light); }

    .stat-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--text-dark);
      transition: transform 0.3s ease;
    }

    body[data-theme="light"] .stat-icon {
      color: var(--text-light);
    }

    .stat-card:hover .stat-icon {
      transform: scale(1.1);
    }

    .stat-open { background: var(--primary-dark); box-shadow: 0 6px 15px rgba(137, 6, 230, 0.3); }
    .stat-progress { background: var(--warning-light); box-shadow: 0 6px 15px rgba(255, 159, 10, 0.3); }
    .stat-resolved { background: var(--success-light); box-shadow: 0 6px 15px rgba(48, 209, 88, 0.3); }
    .stat-total { background: var(--primary-dark); box-shadow: 0 6px 15px rgba(137, 6, 230, 0.3); }
    .stat-approved { background: var(--success-light); box-shadow: 0 6px 15px rgba(48, 209, 88, 0.3); }
    .stat-pending { background: var(--warning-light); box-shadow: 0 6px 15px rgba(255, 159, 10, 0.3); }
    .stat-rejected { background: var(--danger-light); box-shadow: 0 6px 15px rgba(255, 69, 58, 0.3); }

    body[data-theme="light"] .stat-open { background: var(--primary-light); }
    body[data-theme="light"] .stat-total { background: var(--primary-light); }

    .stat-info h3 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 6px;
      color: var(--text-dark);
    }

    body[data-theme="light"] .stat-info h3 {
      color: var(--text-light);
    }

    .stat-info p {
      color: var(--text-secondary-dark);
      font-size: 14px;
      font-weight: 500;
    }

    body[data-theme="light"] .stat-info p {
      color: var(--text-secondary-light);
    }

    .filters-card {
      background: var(--surface-dark);
      border-radius: var(--border-radius);
      padding: 24px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      margin-bottom: 24px;
      border: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .filters-card {
      background: var(--surface-light);
      border: 1px solid var(--border-light);
    }

    .filters-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .filters-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-dark);
    }

    body[data-theme="light"] .filters-title {
      color: var(--text-light);
    }

    .toggle-filters {
      background: transparent;
      border: none;
      color: var(--primary-dark);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      font-size: 15px;
    }

    body[data-theme="light"] .toggle-filters {
      color: var(--primary-light);
    }

    .filters-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 18px;
    }

    .filter-group {
      margin-bottom: 12px;
    }

    .filter-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-dark);
      font-size: 15px;
    }

    body[data-theme="light"] .filter-group label {
      color: var(--text-light);
    }

    .filter-select, .filter-input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-dark);
      border-radius: var(--border-radius);
      font-size: 15px;
      transition: var(--transition);
      background: var(--background-dark);
      color: var(--text-dark);
    }

    body[data-theme="light"] .filter-select,
    body[data-theme="light"] .filter-input {
      border: 1px solid var(--border-light);
      background: var(--background-light);
      color: var(--text-light);
    }

    .filter-select:focus, .filter-input:focus {
      outline: none;
      border-color: var(--primary-dark);
      box-shadow: 0 0 0 2px rgba(137, 6, 230, 0.2);
    }

    body[data-theme="light"] .filter-select:focus,
    body[data-theme="light"] .filter-input:focus {
      border-color: var(--primary-light);
    }

    .form-card {
      background: var(--surface-dark);
      border-radius: var(--border-radius);
      padding: 28px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      margin-bottom: 32px;
      border: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .form-card {
      background: var(--surface-light);
      border: 1px solid var(--border-light);
    }

    .form-card h2 {
      margin-bottom: 24px;
      color: var(--text-dark);
      font-size: 24px;
      font-weight: 700;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .form-card h2 {
      color: var(--text-light);
      border-bottom: 1px solid var(--border-light);
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-dark);
      font-size: 15px;
    }

    body[data-theme="light"] .form-group label {
      color: var(--text-light);
    }

    .form-control {
      width: 100%;
      padding: 14px;
      border: 1px solid var(--border-dark);
      border-radius: var(--border-radius);
      font-size: 15px;
      transition: var(--transition);
      background: var(--background-dark);
      color: var(--text-dark);
    }

    body[data-theme="light"] .form-control {
      border: 1px solid var(--border-light);
      background: var(--background-light);
      color: var(--text-light);
    }

    textarea.form-control {
      min-height: 120px;
      resize: vertical;
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary-dark);
      box-shadow: 0 0 0 2px rgba(137, 6, 230, 0.2);
    }

    body[data-theme="light"] .form-control:focus {
      border-color: var(--primary-light);
    }

    .btn-primary {
      background: var(--primary-dark);
      color: var(--text-dark);
      border: none;
      padding: 14px 24px;
      border-radius: var(--border-radius);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 12px rgba(137, 6, 230, 0.25);
    }

    body[data-theme="light"] .btn-primary {
      background: var(--primary-light);
      color: var(--text-light);
    }

    .btn-primary:hover {
      background: #7A05CC;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(137, 6, 230, 0.3);
    }

    body[data-theme="light"] .btn-primary:hover {
      background: #7A05CC;
    }

    .table-card {
      background: var(--surface-dark);
      border-radius: var(--border-radius);
      padding: 28px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .table-card {
      background: var(--surface-light);
      border: 1px solid var(--border-light);
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .table-header h2 {
      color: var(--text-dark);
      font-size: 24px;
      font-weight: 700;
    }

    body[data-theme="light"] .table-header h2 {
      color: var(--text-light);
    }

    .table-actions {
      display: flex;
      gap: 12px;
    }

    .btn-secondary {
      background: var(--background-dark);
      color: var(--text-dark);
      border: none;
      padding: 10px 16px;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      font-size: 15px;
      transition: var(--transition);
    }

    body[data-theme="light"] .btn-secondary {
      background: var(--background-light);
      color: var(--text-light);
    }

    .btn-secondary:hover {
      background: var(--border-dark);
    }

    body[data-theme="light"] .btn-secondary:hover {
      background: var(--border-light);
    }

    .search-box {
      display: flex;
      align-items: center;
      background: var(--background-dark);
      padding: 10px 16px;
      border-radius: var(--border-radius);
      width: 300px;
      transition: var(--transition);
      border: 1px solid var(--border-dark);
    }

    body[data-theme="light"] .search-box {
      background: var(--background-light);
      border: 1px solid var(--border-light);
    }

    .search-box:focus-within {
      border-color: var(--primary-dark);
      box-shadow: 0 0 0 2px rgba(137, 6, 230, 0.2);
    }

    body[data-theme="light"] .search-box:focus-within {
      border-color: var(--primary-light);
    }

    .search-box i {
      color: var(--text-secondary-dark);
      margin-right: 10px;
    }

    body[data-theme="light"] .search-box i {
      color: var(--text-secondary-light);
    }

    .search-box input {
      border: none;
      background: transparent;
      width: 100%;
      font-size: 15px;
      color: var(--text-dark);
    }

    body[data-theme="light"] .search-box input {
      color: var(--text-light);
    }

    .search-box input:focus {
      outline: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: var(--background-dark);
    }

    body[data-theme="light"] thead {
      background: var(--background-light);
    }

    th, td {
      padding: 14px 16px;
      text-align: left;
      border-bottom: 1px solid var(--border-dark);
      color: var(--text-dark);
    }

    body[data-theme="light"] th,
    body[data-theme="light"] td {
      border-bottom: 1px solid var(--border-light);
      color: var(--text-light);
    }

    th {
      font-weight: 600;
      color: var(--text-secondary-dark);
      font-size: 15px;
    }

    body[data-theme="light"] th {
      color: var(--text-secondary-light);
    }

    td {
      font-size: 15px;
    }

    tbody tr {
      transition: var(--transition);
    }

    tbody tr:hover {
      background: var(--background-dark);
    }

    body[data-theme="light"] tbody tr:hover {
      background: var(--background-light);
    }

    .badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }

    .badge-open { background: rgba(255, 69, 58, 0.2); color: var(--danger-light); }
    .badge-progress { background: rgba(255, 159, 10, 0.2); color: var(--warning-light); }
    .badge-resolved { background: rgba(48, 209, 88, 0.2); color: var(--success-light); }
    .badge-approved { background: rgba(48, 209, 88, 0.2); color: var(--success-light); }
    .badge-pending { background: rgba(255, 159, 10, 0.2); color: var(--warning-light); }
    .badge-rejected { background: rgba(255, 69, 58, 0.2); color: var(--danger-light); }
    .badge-completed { background: rgba(48, 209, 88, 0.2); color: var(--success-light); }
    .badge-planned { background: rgba(137, 6, 230, 0.2); color: var(--primary-dark); }

    body[data-theme="light"] .badge-planned {
      background: rgba(137, 6, 230, 0.2);
      color: var(--primary-light);
    }

    .priority-high { border-left: 4px solid var(--danger-light); }
    .priority-medium { border-left: 4px solid var(--warning-light); }
    .priority-low { border-left: 4px solid var(--success-light); }

    .actions {
      display: flex;
      gap: 10px;
    }

    .btn-icon {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-secondary-dark);
      transition: var(--transition);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body[data-theme="light"] .btn-icon {
      color: var(--text-secondary-light);
    }

    .btn-icon:hover {
      background: var(--background-dark);
    }

    body[data-theme="light"] .btn-icon:hover {
      background: var(--background-light);
    }

    .btn-edit:hover { color: var(--primary-dark); }
    .btn-delete:hover { color: var(--danger-light); }
    .btn-view:hover { color: var(--success-light); }

    body[data-theme="light"] .btn-edit:hover { color: var(--primary-light); }

    .empty-state {
      text-align: center;
      padding: 60px 0;
      color: var(--text-secondary-dark);
    }

    body[data-theme="light"] .empty-state {
      color: var(--text-secondary-light);
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state p {
      font-size: 17px;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: var(--surface-dark);
      border-radius: var(--border-radius);
      width: 100%;
      max-width: 600px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      max-height: 90vh;
      overflow-y: auto;
    }

    body[data-theme="light"] .modal-content {
      background: var(--surface-light);
    }

    .modal-header {
      padding: 24px;
      border-bottom: 1px solid var(--border-dark);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    body[data-theme="light"] .modal-header {
      border-bottom: 1px solid var(--border-light);
    }

    .modal-header h3 {
      margin: 0;
      color: var(--text-dark);
      font-size: 20px;
      font-weight: 600;
    }

    body[data-theme="light"] .modal-header h3 {
      color: var(--text-light);
    }

    .close {
      background: transparent;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-secondary-dark);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    body[data-theme="light"] .close {
      color: var(--text-secondary-light);
    }

    .close:hover {
      background: var(--background-dark);
    }

    body[data-theme="light"] .close:hover {
      background: var(--background-light);
    }

    .modal-body {
      padding: 24px;
      color: var(--text-dark);
    }

    body[data-theme="light"] .modal-body {
      color: var(--text-light);
    }

    .modal-footer {
      padding: 20px 24px;
      border-top: 1px solid var(--border-dark);
      text-align: right;
    }

    body[data-theme="light"] .modal-footer {
      border-top: 1px solid var(--border-light);
    }

    .btn-cancel {
      background: var(--background-dark);
      color: var(--text-dark);
      border: none;
      padding: 10px 20px;
      border-radius: var(--border-radius);
      cursor: pointer;
      margin-right: 12px;
      font-weight: 500;
      transition: var(--transition);
    }

    body[data-theme="light"] .btn-cancel {
      background: var(--background-light);
      color: var(--text-light);
    }

    .btn-cancel:hover {
      background: var(--border-dark);
    }

    body[data-theme="light"] .btn-cancel:hover {
      background: var(--border-light);
    }

    .btn-confirm {
      background: var(--danger-light);
      color: var(--text-dark);
      border: none;
      padding: 10px 20px;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-weight: 500;
      transition: var(--transition);
    }

    .btn-confirm:hover {
      background: #D70015;
    }

    .incident-details {
      margin-bottom: 24px;
    }

    .detail-row {
      display: flex;
      margin-bottom: 16px;
    }

    .detail-label {
      font-weight: 600;
      min-width: 120px;
      color: var(--text-secondary-dark);
    }

    body[data-theme="light"] .detail-label {
      color: var(--text-secondary-light);
    }

    .detail-value {
      flex: 1;
    }

    .charts-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }

    .chart-card {
      background: var(--surface-dark);
      border-radius: var(--border-radius);
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid var(--border-dark);
      transition: var(--transition);
    }

    body[data-theme="light"] .chart-card {
      background: var(--surface-light);
      border: 1px solid var(--border-light);
    }

    .chart-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .chart-header h3 {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-dark);
    }

    body[data-theme="light"] .chart-header h3 {
      color: var(--text-light);
    }

    .chart-filter {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--border-dark);
      color: var(--text-dark);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      cursor: pointer;
      transition: var(--transition);
    }

    body[data-theme="light"] .chart-filter {
      border: 1px solid var(--border-light);
      color: var(--text-light);
    }

    .chart-filter:hover {
      background: rgba(137, 6, 230, 0.15);
    }

    .chart-container {
      position: relative;
      height: 220px;
      width: 100%;
    }

    @media (max-width: 1200px) {
      .charts-section {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 992px) {
      .container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid var(--border-dark);
      }

      body[data-theme="light"] .sidebar {
        border-bottom: 1px solid var(--border-light);
      }

      .nav-menu {
        display: flex;
        overflow-x: auto;
        padding: 0 12px 12px;
      }

      .nav-item {
        flex-shrink: 0;
      }

      .nav-link {
        padding: 10px 14px;
      }

      .main-content {
        padding: 20px;
      }
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .btn-group {
        width: 100%;
        justify-content: space-between;
      }

      .stats-cards,
      .form-row {
        grid-template-columns: 1fr;
      }

      .header h1 {
        font-size: 24px;
      }

      .chart-card {
        padding: 16px;
      }

      .search-box {
        width: 100%;
      }
    }

    @media (max-width: 576px) {
      .main-content {
        padding: 16px;
      }

      .header h1 {
        font-size: 20px;
      }

      .stat-card {
        flex-direction: column;
        text-align: center;
        padding: 16px;
      }

      .tabs {
        flex-direction: column;
        align-items: flex-start;
      }

      .tab {
        width: 100%;
        text-align: left;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <div class="container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="logo1.png" alt="Solution Tecnologia Logo" class="logo">
        <h2></i> Solution Tecnologia</h2>
      </div>

      <div class="user-info">
        <p>Bem-vindo, <strong id="username">Administrador</strong></p>
        <p><span class="role-badge" id="userrole">Administrador</span></p>
      </div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="dashboard-adm.html" class="nav-link">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="itiladm.html" class="nav-link active">
            <i class="fas fa-tasks"></i>
            <span>ITIL - Incidentes</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="lgpd-adm.html" class="nav-link">
            <i class="fas fa-shield-alt"></i>
            <span>LGPD - Requisições</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="network.html" class="nav-link">
            <i class="fas fa-network-wired"></i>
            <span>Monitoramento</span>
          </a>
        </li>
      </ul>
      <div class="sidebar-footer">
         Solution Tecnologia &copy; 2025
      </div>
    </aside>
    <main class="main-content">
      <div class="header">
        <h1><i class="fas fa-tasks"></i> ITIL - Gerenciamento</h1>
        <div class="btn-group">
          <a href="dashboard-adm.html" class="back-btn"><i class="fas fa-arrow-left"></i> Voltar</a>
                    <button class="logout-btn" onclick="window.location.href='../../login.html'" aria-label="Sair">
            <i class="fas fa-sign-out-alt"></i> Sair
          </button>
          <button class="theme-toggle" id="theme-toggle"><i class="fas fa-sun"></i></button>
        </div>
      </div>
      <div class="tabs">
        <button class="tab active" data-tab="incidents">Incidentes</button>
        <button class="tab" data-tab="problems">Problemas</button>
        <button class="tab" data-tab="changes">Mudanças</button>
        <button class="tab" data-tab="releases">Liberações</button>
        <button class="tab" data-tab="service-levels">Nível de Serviço</button>
        <button class="tab" data-tab="financial">Financeiro</button>
        <button class="tab" data-tab="capacity">Capacidade</button>
        <button class="tab" data-tab="availability">Disponibilidade</button>
        <button class="tab" data-tab="continuity">Continuidade</button>
      </div>
      <!-- Incidentes -->
      <div class="tab-content active" id="incidents">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-exclamation-circle"></i></div>
            <div class="stat-info">
              <h3 id="open-incidents">8</h3>
              <p>Incidentes Abertos</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-spinner"></i></div>
            <div class="stat-info">
              <h3 id="progress-incidents">9</h3>
              <p>Em Andamento</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-resolved"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="resolved-incidents">7</h3>
              <p>Resolvidos</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-total"><i class="fas fa-tachometer-alt"></i></div>
            <div class="stat-info">
              <h3 id="total-incidents">24</h3>
              <p>Total de Incidentes</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Status de Incidentes</h3>
              <select class="chart-filter" id="incidents-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="incidents-chart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <h3>Categorias de Incidentes</h3>
              <select class="chart-filter" id="categories-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="categories-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo Incidente</h2>
          <form id="incident-form">
            <div class="form-row">
              <div class="form-group">
                <label for="incident-title">Título</label>
                <input type="text" id="incident-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="incident-priority">Prioridade</label>
                <select id="incident-priority" class="form-control" required>
                  <option value="Baixa">Baixa</option>
                  <option value="Média">Média</option>
                  <option value="Alta">Alta</option>
                  <option value="Crítica">Crítica</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="incident-description">Descrição</label>
              <textarea id="incident-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar Incidente</button>
          </form>
        </div>
        <div class="filters-card">
          <div class="filters-header">
            <h3 class="filters-title">Filtros</h3>
            <button class="toggle-filters"><i class="fas fa-filter"></i> Mostrar Filtros</button>
          </div>
          <div class="filters-content" style="display: none;">
            <div class="form-row">
              <div class="filter-group">
                <label for="filter-status">Status</label>
                <select id="filter-status" class="filter-select">
                  <option value="">Todos</option>
                  <option value="Pendente">Pendente</option>
                  <option value="Em Andamento">Em Andamento</option>
                  <option value="Resolvido">Resolvido</option>
                </select>
              </div>
              <div class="filter-group">
                <label for="filter-priority">Prioridade</label>
                <select id="filter-priority" class="filter-select">
                  <option value="">Todas</option>
                  <option value="Baixa">Baixa</option>
                  <option value="Média">Média</option>
                  <option value="Alta">Alta</option>
                  <option value="Crítica">Crítica</option>
                </select>
              </div>
              <div class="filter-group">
                <label for="filter-date">Data</label>
                <input type="date" id="filter-date" class="filter-input">
              </div>
            </div>
          </div>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Incidentes</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshIncidents()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-incidents" placeholder="Pesquisar incidentes...">
              </div>
            </div>
          </div>
          <table id="incidents-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Descrição</th>
                <th>Prioridade</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Problemas -->
      <div class="tab-content" id="problems">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="stat-info">
              <h3 id="open-problems">5</h3>
              <p>Problemas Abertos</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-tools"></i></div>
            <div class="stat-info">
              <h3 id="progress-problems">3</h3>
              <p>Em Análise</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-resolved"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="resolved-problems">4</h3>
              <p>Resolvidos</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Status de Problemas</h3>
              <select class="chart-filter" id="problems-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="problems-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo Problema</h2>
          <form id="problem-form">
            <div class="form-row">
              <div class="form-group">
                <label for="problem-title">Título</label>
                <input type="text" id="problem-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="problem-priority">Prioridade</label>
                <select id="problem-priority" class="form-control" required>
                  <option value="Baixa">Baixa</option>
                  <option value="Média">Média</option>
                  <option value="Alta">Alta</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="problem-description">Descrição</label>
              <textarea id="problem-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar Problema</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Problemas</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshProblems()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-problems" placeholder="Pesquisar problemas...">
              </div>
            </div>
          </div>
          <table id="problems-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Descrição</th>
                <th>Prioridade</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Mudanças -->
      <div class="tab-content" id="changes">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-sync-alt"></i></div>
            <div class="stat-info">
              <h3 id="open-changes">6</h3>
              <p>Mudanças Abertas</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-cogs"></i></div>
            <div class="stat-info">
              <h3 id="progress-changes">4</h3>
              <p>Em Aprovação</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-approved"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="approved-changes">5</h3>
              <p>Aprovadas</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Status de Mudanças</h3>
              <select class="chart-filter" id="changes-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="changes-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Nova Mudança</h2>
          <form id="change-form">
            <div class="form-row">
              <div class="form-group">
                <label for="change-title">Título</label>
                <input type="text" id="change-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="change-type">Tipo</label>
                <select id="change-type" class="form-control" required>
                  <option value="Normal">Normal</option>
                  <option value="Urgente">Urgente</option>
                  <option value="Emergencial">Emergencial</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="change-description">Descrição</label>
              <textarea id="change-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar Mudança</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Mudanças</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshChanges()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-changes" placeholder="Pesquisar mudanças...">
              </div>
            </div>
          </div>
          <table id="changes-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Tipo</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Liberações -->
      <div class="tab-content" id="releases">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-planned"><i class="fas fa-rocket"></i></div>
            <div class="stat-info">
              <h3 id="planned-releases">4</h3>
              <p>Liberações Planejadas</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-spinner"></i></div>
            <div class="stat-info">
              <h3 id="progress-releases">3</h3>
              <p>Em Implantação</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="completed-releases">5</h3>
              <p>Concluídas</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Status de Liberações</h3>
              <select class="chart-filter" id="releases-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="releases-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Nova Liberação</h2>
          <form id="release-form">
            <div class="form-row">
              <div class="form-group">
                <label for="release-title">Título</label>
                <input type="text" id="release-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="release-type">Tipo</label>
                <select id="release-type" class="form-control" required>
                  <option value="Major">Major</option>
                  <option value="Minor">Minor</option>
                  <option value="Emergencial">Emergencial</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="release-description">Descrição</label>
              <textarea id="release-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar Liberação</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Liberações</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshReleases()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-releases" placeholder="Pesquisar liberações...">
              </div>
            </div>
          </div>
          <table id="releases-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Tipo</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Nível de Serviço -->
      <div class="tab-content" id="service-levels">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-file-contract"></i></div>
            <div class="stat-info">
              <h3 id="active-service-levels">6</h3>
              <p>SLAs Ativos</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-chart-line"></i></div>
            <div class="stat-info">
              <h3 id="breached-service-levels">2</h3>
              <p>SLAs Violados</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="met-service-levels">8</h3>
              <p>SLAs Atendidos</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Desempenho de SLAs</h3>
              <select class="chart-filter" id="service-levels-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="service-levels-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo SLA</h2>
          <form id="service-level-form">
            <div class="form-row">
              <div class="form-group">
                <label for="service-level-title">Título</label>
                <input type="text" id="service-level-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="service-level-target">Meta (%)</label>
                <input type="number" id="service-level-target" class="form-control" required min="0" max="100">
              </div>
            </div>
            <div class="form-group">
              <label for="service-level-description">Descrição</label>
              <textarea id="service-level-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar SLA</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de SLAs</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshServiceLevels()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-service-levels" placeholder="Pesquisar SLAs...">
              </div>
            </div>
          </div>
          <table id="service-levels-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Meta (%)</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Financeiro -->
      <div class="tab-content" id="financial">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-dollar-sign"></i></div>
            <div class="stat-info">
              <h3 id="budget-allocated">R$ 500K</h3>
              <p>Orçamento Alocado</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-money-bill-wave"></i></div>
            <div class="stat-info">
              <h3 id="budget-spent">R$ 350K</h3>
              <p>Orçamento Gasto</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-piggy-bank"></i></div>
            <div class="stat-info">
              <h3 id="budget-remaining">R$ 150K</h3>
              <p>Orçamento Restante</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Gastos por Categoria</h3>
              <select class="chart-filter" id="financial-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="financial-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Nova Despesa</h2>
          <form id="financial-form">
            <div class="form-row">
              <div class="form-group">
                <label for="financial-title">Título</label>
                <input type="text" id="financial-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="financial-amount">Valor (R$)</label>
                <input type="number" id="financial-amount" class="form-control" required min="0" step="0.01">
              </div>
            </div>
            <div class="form-group">
              <label for="financial-description">Descrição</label>
              <textarea id="financial-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Adicionar Despesa</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Despesas</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshFinancial()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-financial" placeholder="Pesquisar despesas...">
              </div>
            </div>
          </div>
          <table id="financial-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Valor (R$)</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Capacidade -->
      <div class="tab-content" id="capacity">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-server"></i></div>
            <div class="stat-info">
              <h3 id="capacity-utilization">75%</h3>
              <p>Utilização de Recursos</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-tachometer-alt"></i></div>
            <div class="stat-info">
              <h3 id="capacity-issues">3</h3>
              <p>Problemas de Capacidade</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="capacity-optimized">5</h3>
              <p>Recursos Otimizados</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Utilização de Recursos</h3>
              <select class="chart-filter" id="capacity-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="capacity-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo Relatório de Capacidade</h2>
          <form id="capacity-form">
            <div class="form-row">
              <div class="form-group">
                <label for="capacity-title">Título</label>
                <input type="text" id="capacity-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="capacity-utilization">Utilização (%)</label>
                <input type="number" id="capacity-utilization" class="form-control" required min="0" max="100">
              </div>
            </div>
            <div class="form-group">
              <label for="capacity-description">Descrição</label>
              <textarea id="capacity-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Adicionar Relatório</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Relatórios de Capacidade</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshCapacity()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-capacity" placeholder="Pesquisar relatórios...">
              </div>
            </div>
          </div>
          <table id="capacity-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Utilização (%)</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Disponibilidade -->
      <div class="tab-content" id="availability">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-clock"></i></div>
            <div class="stat-info">
              <h3 id="availability-rate">99.5%</h3>
              <p>Taxa de Disponibilidade</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="stat-info">
              <h3 id="availability-issues">2</h3>
              <p>Incidentes de Disponibilidade</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="availability-improved">4</h3>
              <p>Serviços Melhorados</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Taxa de Disponibilidade</h3>
              <select class="chart-filter" id="availability-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="availability-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo Relatório de Disponibilidade</h2>
          <form id="availability-form">
            <div class="form-row">
              <div class="form-group">
                <label for="availability-title">Título</label>
                <input type="text" id="availability-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="availability-rate">Taxa (%)</label>
                <input type="number" id="availability-rate" class="form-control" required min="0" max="100" step="0.1">
              </div>
            </div>
            <div class="form-group">
              <label for="availability-description">Descrição</label>
              <textarea id="availability-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Adicionar Relatório</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Relatórios de Disponibilidade</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshAvailability()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-availability" placeholder="Pesquisar relatórios...">
              </div>
            </div>
          </div>
          <table id="availability-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Taxa (%)</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Continuidade -->
      <div class="tab-content" id="continuity">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon stat-open"><i class="fas fa-shield-alt"></i></div>
            <div class="stat-info">
              <h3 id="continuity-plans">5</h3>
              <p>Planos de Continuidade</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-progress"><i class="fas fa-spinner"></i></div>
            <div class="stat-info">
              <h3 id="continuity-tests">3</h3>
              <p>Testes em Andamento</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon stat-completed"><i class="fas fa-check-circle"></i></div>
            <div class="stat-info">
              <h3 id="continuity-success">4</h3>
              <p>Testes Concluídos</p>
            </div>
          </div>
        </div>
        <div class="charts-section">
          <div class="chart-card">
            <div class="chart-header">
              <h3>Status de Planos de Continuidade</h3>
              <select class="chart-filter" id="continuity-chart-filter">
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mês</option>
                <option value="quarter">Este Trimestre</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="continuity-chart"></canvas>
            </div>
          </div>
        </div>
        <div class="form-card">
          <h2>Novo Plano de Continuidade</h2>
          <form id="continuity-form">
            <div class="form-row">
              <div class="form-group">
                <label for="continuity-title">Título</label>
                <input type="text" id="continuity-title" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="continuity-status">Status</label>
                <select id="continuity-status" class="form-control" required>
                  <option value="Planejado">Planejado</option>
                  <option value="Em Teste">Em Teste</option>
                  <option value="Concluído">Concluído</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="continuity-description">Descrição</label>
              <textarea id="continuity-description" class="form-control" required></textarea>
            </div>
            <button type="submit" class="btn-primary"><i class="fas fa-plus"></i> Criar Plano</button>
          </form>
        </div>
        <div class="table-card">
          <div class="table-header">
            <h2>Lista de Planos de Continuidade</h2>
            <div class="table-actions">
              <button class="btn-secondary" onclick="refreshContinuity()"><i class="fas fa-sync"></i> Atualizar</button>
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-continuity" placeholder="Pesquisar planos...">
              </div>
            </div>
          </div>
          <table id="continuity-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Título</th>
                <th>Status</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Modals -->
      <div class="modal" id="incident-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do Incidente</h3>
            <button class="close" onclick="closeModal('incident-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-incident-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-incident-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-incident-description"></span></div>
              <div class="detail-row"><span class="detail-label">Prioridade:</span><span class="detail-value" id="modal-incident-priority"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-incident-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-incident-date"></span></div>
              <div class="detail-row"><span class="detail-label">Usuário:</span><span class="detail-value" id="modal-incident-user"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('incident-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-incident-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-incident-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este incidente?</p>
            <p><strong>ID:</strong> <span id="delete-incident-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-incident-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteIncident()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="problem-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do Problema</h3>
            <button class="close" onclick="closeModal('problem-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-problem-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-problem-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-problem-description"></span></div>
              <div class="detail-row"><span class="detail-label">Prioridade:</span><span class="detail-value" id="modal-problem-priority"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-problem-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-problem-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('problem-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-problem-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-problem-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este problema?</p>
            <p><strong>ID:</strong> <span id="delete-problem-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-problem-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteProblem()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="change-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes da Mudança</h3>
            <button class="close" onclick="closeModal('change-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-change-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-change-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-change-description"></span></div>
              <div class="detail-row"><span class="detail-label">Tipo:</span><span class="detail-value" id="modal-change-type"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-change-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-change-date"></span></div>
                            <span class="detail-value" id="modal-change-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('change-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-change-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-change-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir esta mudança?</p>
            <p><strong>ID:</strong> <span id="delete-change-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-change-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteChange()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="release-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes da Liberação</h3>
            <button class="close" onclick="closeModal('release-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-release-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-release-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-release-description"></span></div>
              <div class="detail-row"><span class="detail-label">Tipo:</span><span class="detail-value" id="modal-release-type"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-release-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-release-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('release-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-release-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-release-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir esta liberação?</p>
            <p><strong>ID:</strong> <span id="delete-release-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-release-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteRelease()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="service-level-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do SLA</h3>
            <button class="close" onclick="closeModal('service-level-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-service-level-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-service-level-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-service-level-description"></span></div>
              <div class="detail-row"><span class="detail-label">Meta (%):</span><span class="detail-value" id="modal-service-level-target"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-service-level-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-service-level-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('service-level-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-service-level-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-service-level-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este SLA?</p>
            <p><strong>ID:</strong> <span id="delete-service-level-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-service-level-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteServiceLevel()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="financial-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes da Despesa</h3>
            <button class="close" onclick="closeModal('financial-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-financial-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-financial-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-financial-description"></span></div>
              <div class="detail-row"><span class="detail-label">Valor (R$):</span><span class="detail-value" id="modal-financial-amount"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-financial-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('financial-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-financial-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-financial-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir esta despesa?</p>
            <p><strong>ID:</strong> <span id="delete-financial-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-financial-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteFinancial()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="capacity-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do Relatório de Capacidade</h3>
            <button class="close" onclick="closeModal('capacity-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-capacity-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-capacity-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-capacity-description"></span></div>
              <div class="detail-row"><span class="detail-label">Utilização (%):</span><span class="detail-value" id="modal-capacity-utilization"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-capacity-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('capacity-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-capacity-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-capacity-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este relatório de capacidade?</p>
            <p><strong>ID:</strong> <span id="delete-capacity-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-capacity-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteCapacity()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="availability-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do Relatório de Disponibilidade</h3>
            <button class="close" onclick="closeModal('availability-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-availability-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-availability-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-availability-description"></span></div>
              <div class="detail-row"><span class="detail-label">Taxa (%):</span><span class="detail-value" id="modal-availability-rate"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-availability-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('availability-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-availability-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-availability-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este relatório de disponibilidade?</p>
            <p><strong>ID:</strong> <span id="delete-availability-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-availability-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteAvailability()">Confirmar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="continuity-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Detalhes do Plano de Continuidade</h3>
            <button class="close" onclick="closeModal('continuity-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <div class="incident-details">
              <div class="detail-row"><span class="detail-label">ID:</span><span class="detail-value" id="modal-continuity-id"></span></div>
              <div class="detail-row"><span class="detail-label">Título:</span><span class="detail-value" id="modal-continuity-title"></span></div>
              <div class="detail-row"><span class="detail-label">Descrição:</span><span class="detail-value" id="modal-continuity-description"></span></div>
              <div class="detail-row"><span class="detail-label">Status:</span><span class="detail-value" id="modal-continuity-status"></span></div>
              <div class="detail-row"><span class="detail-label">Data:</span><span class="detail-value" id="modal-continuity-date"></span></div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('continuity-modal')">Fechar</button>
          </div>
        </div>
      </div>
      <div class="modal" id="delete-continuity-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Confirmar Exclusão</h3>
            <button class="close" onclick="closeModal('delete-continuity-modal')"><i class="fas fa-times"></i></button>
          </div>
          <div class="modal-body">
            <p>Tem certeza que deseja excluir este plano de continuidade?</p>
            <p><strong>ID:</strong> <span id="delete-continuity-id"></span></p>
          </div>
          <div class="modal-footer">
            <button class="btn-cancel" onclick="closeModal('delete-continuity-modal')">Cancelar</button>
            <button class="btn-confirm" onclick="confirmDeleteContinuity()">Confirmar</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script>
// Theme Toggle
const themeToggle = document.getElementById('theme-toggle');
const body = document.body;
let currentTheme = localStorage.getItem('theme') || 'dark';
body.setAttribute('data-theme', currentTheme);
themeToggle.innerHTML = `<i class="fas fa-${currentTheme === 'dark' ? 'sun' : 'moon'}"></i>`;

themeToggle.addEventListener('click', () => {
  currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
  body.setAttribute('data-theme', currentTheme);
  localStorage.setItem('theme', currentTheme);
  themeToggle.innerHTML = `<i class="fas fa-${currentTheme === 'dark' ? 'sun' : 'moon'}"></i>`;
  updateAllCharts();
});

// Chart Colors Based on Theme
function getChartColors() {
  return body.getAttribute('data-theme') === 'dark' ? {
    open: 'rgba(255, 69, 58, 0.7)',
    progress: 'rgba(255, 159, 10, 0.7)',
    resolved: 'rgba(48, 209, 88, 0.7)',
    total: 'rgba(10, 132, 255, 0.7)',
    approved: 'rgba(48, 209, 88, 0.7)',
    pending: 'rgba(255, 159, 10, 0.7)',
    rejected: 'rgba(255, 69, 58, 0.7)',
    planned: 'rgba(10, 132, 255, 0.7)',
    completed: 'rgba(48, 209, 88, 0.7)',
    background: 'rgba(255, 255, 255, 0.1)',
    border: 'rgba(255, 255, 255, 0.2)'
  } : {
    open: 'rgba(255, 59, 48, 0.7)',
    progress: 'rgba(255, 149, 0, 0.7)',
    resolved: 'rgba(40, 167, 69, 0.7)',
    total: 'rgba(0, 122, 255, 0.7)',
    approved: 'rgba(40, 167, 69, 0.7)',
    pending: 'rgba(255, 149, 0, 0.7)',
    rejected: 'rgba(255, 59, 48, 0.7)',
    planned: 'rgba(0, 122, 255, 0.7)',
    completed: 'rgba(40, 167, 69, 0.7)',
    background: 'rgba(0, 0, 0, 0.1)',
    border: 'rgba(0, 0, 0, 0.2)'
  };
}

// Initialize Charts
let incidentsChart, categoriesChart, problemsChart, changesChart, releasesChart, serviceLevelsChart, financialChart, capacityChart, availabilityChart, continuityChart;

function initializeCharts() {
  const colors = getChartColors();
  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: { position: 'top', labels: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } },
      tooltip: { backgroundColor: getComputedStyle(document.body).getPropertyValue('--surface-dark').trim() }
    }
  };

  incidentsChart = new Chart(document.getElementById('incidents-chart').getContext('2d'), {
    type: 'doughnut',
    data: { labels: ['Abertos', 'Em Andamento', 'Resolvidos'], datasets: [{ data: [0, 0, 0], backgroundColor: [colors.open, colors.progress, colors.resolved], borderColor: colors.border, borderWidth: 1 }] },
    options: chartOptions
  });
  categoriesChart = new Chart(document.getElementById('categories-chart').getContext('2d'), {
    type: 'pie',
    data: { labels: ['Hardware', 'Software', 'Rede', 'Outros'], datasets: [{ data: [0, 0, 0, 0], backgroundColor: [colors.open, colors.progress, colors.resolved, colors.total], borderColor: colors.border, borderWidth: 1 }] },
    options: chartOptions
  });
  problemsChart = new Chart(document.getElementById('problems-chart').getContext('2d'), {
    type: 'bar',
    data: { labels: ['Abertos', 'Em Análise', 'Resolvidos'], datasets: [{ label: 'Problemas', data: [0, 0, 0], backgroundColor: colors.progress, borderColor: colors.border, borderWidth: 1 }] },
    options: { ...chartOptions, scales: { y: { beginAtZero: true, ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } }
  });
  changesChart = new Chart(document.getElementById('changes-chart').getContext('2d'), {
    type: 'doughnut',
    data: { labels: ['Abertas', 'Em Aprovação', 'Aprovadas'], datasets: [{ data: [0, 0, 0], backgroundColor: [colors.open, colors.pending, colors.approved], borderColor: colors.border, borderWidth: 1 }] },
    options: chartOptions
  });
  releasesChart = new Chart(document.getElementById('releases-chart').getContext('2d'), {
    type: 'bar',
    data: { labels: ['Planejadas', 'Em Implantação', 'Concluídas'], datasets: [{ label: 'Liberações', data: [0, 0, 0], backgroundColor: colors.planned, borderColor: colors.border, borderWidth: 1 }] },
    options: { ...chartOptions, scales: { y: { beginAtZero: true, ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } }
  });
  serviceLevelsChart = new Chart(document.getElementById('service-levels-chart').getContext('2d'), {
    type: 'line',
    data: { labels: ['Ativos', 'Violados', 'Atendidos'], datasets: [{ label: 'SLAs', data: [0, 0, 0], borderColor: colors.approved, backgroundColor: colors.background, fill: true }] },
    options: { ...chartOptions, scales: { y: { beginAtZero: true, ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } }
  });
  financialChart = new Chart(document.getElementById('financial-chart').getContext('2d'), {
    type: 'pie',
    data: { labels: ['Hardware', 'Software', 'Serviços', 'Outros'], datasets: [{ data: [0, 0, 0, 0], backgroundColor: [colors.open, colors.progress, colors.resolved, colors.total], borderColor: colors.border, borderWidth: 1 }] },
    options: chartOptions
  });
  capacityChart = new Chart(document.getElementById('capacity-chart').getContext('2d'), {
    type: 'line',
    data: { labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'], datasets: [{ label: 'Utilização (%)', data: [0, 0, 0, 0], borderColor: colors.total, backgroundColor: colors.background, fill: true }] },
    options: { ...chartOptions, scales: { y: { beginAtZero: true, ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } }
  });
  availabilityChart = new Chart(document.getElementById('availability-chart').getContext('2d'), {
    type: 'line',
    data: { labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'], datasets: [{ label: 'Taxa de Disponibilidade (%)', data: [0, 0, 0, 0], borderColor: colors.approved, backgroundColor: colors.background, fill: true }] },
    options: { ...chartOptions, scales: { y: { beginAtZero: true, max: 100, ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } }
  });
  continuityChart = new Chart(document.getElementById('continuity-chart').getContext('2d'), {
    type: 'doughnut',
    data: { labels: ['Planejados', 'Em Teste', 'Concluídos'], datasets: [{ data: [0, 0, 0], backgroundColor: [colors.planned, colors.progress, colors.completed], borderColor: colors.border, borderWidth: 1 }] },
    options: chartOptions
  });
}

function updateAllCharts() {
  const colors = getChartColors();
  const chartOptions = { plugins: { legend: { labels: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  incidentsChart.data.datasets[0].backgroundColor = [colors.open, colors.progress, colors.resolved];
  incidentsChart.options = { ...incidentsChart.options, ...chartOptions };
  incidentsChart.update();
  categoriesChart.data.datasets[0].backgroundColor = [colors.open, colors.progress, colors.resolved, colors.total];
  categoriesChart.options = { ...categoriesChart.options, ...chartOptions };
  categoriesChart.update();
  problemsChart.data.datasets[0].backgroundColor = colors.progress;
  problemsChart.options = { ...problemsChart.options, ...chartOptions, scales: { y: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  problemsChart.update();
  changesChart.data.datasets[0].backgroundColor = [colors.open, colors.pending, colors.approved];
  changesChart.options = { ...changesChart.options, ...chartOptions };
  changesChart.update();
  releasesChart.data.datasets[0].backgroundColor = colors.planned;
  releasesChart.options = { ...releasesChart.options, ...chartOptions, scales: { y: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  releasesChart.update();
  serviceLevelsChart.data.datasets[0].borderColor = colors.approved;
  serviceLevelsChart.options = { ...serviceLevelsChart.options, ...chartOptions, scales: { y: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  serviceLevelsChart.update();
  financialChart.data.datasets[0].backgroundColor = [colors.open, colors.progress, colors.resolved, colors.total];
  financialChart.options = { ...financialChart.options, ...chartOptions };
  financialChart.update();
  capacityChart.data.datasets[0].borderColor = colors.total;
  capacityChart.options = { ...capacityChart.options, ...chartOptions, scales: { y: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  capacityChart.update();
  availabilityChart.data.datasets[0].borderColor = colors.approved;
  availabilityChart.options = { ...availabilityChart.options, ...chartOptions, scales: { y: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } }, x: { ticks: { color: getComputedStyle(document.body).getPropertyValue('--text-dark').trim() } } } };
  availabilityChart.update();
  continuityChart.data.datasets[0].backgroundColor = [colors.planned, colors.progress, colors.completed];
  continuityChart.options = { ...continuityChart.options, ...chartOptions };
  continuityChart.update();
}

// Tab Switching
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    tab.classList.add('active');
    const activeTab = document.getElementById(tab.dataset.tab);
    activeTab.classList.add('active');
    const key = tab.dataset.tab;
    refreshData(key); // Recarrega os dados da aba ativa
  });
});

// Toggle Filters
document.querySelectorAll('.toggle-filters').forEach(button => {
  button.addEventListener('click', () => {
    const content = button.closest('.filters-card').querySelector('.filters-content');
    content.style.display = content.style.display === 'none' ? 'grid' : 'none';
    button.innerHTML = `<i class="fas fa-filter"></i> ${content.style.display === 'none' ? 'Mostrar' : 'Ocultar'} Filtros`;
  });
});

// Data Management
const dataKeys = {
  incidents: 'incidentsData',
  problems: 'problemsData',
  changes: 'changesData',
  releases: 'releasesData',
  serviceLevels: 'serviceLevelsData',
  financial: 'financialData',
  capacity: 'capacityData',
  availability: 'availabilityData',
  continuity: 'continuityData'
};

function initializeData() {
  const defaultData = {
    incidents: [{ id: 1, title: 'Falha no Servidor', description: 'Servidor principal offline', priority: 'Alta', status: 'Pendente', date: '2025-09-17', user: 'Carlos Silva' }],
    problems: [{ id: 1, title: 'Problema Recorrente', description: 'Falhas intermitentes no sistema', priority: 'Alta', status: 'Em Análise', date: '2025-09-15' }],
    changes: [{ id: 1, title: 'Atualização de Software', description: 'Atualização do ERP', type: 'Normal', status: 'Aprovada', date: '2025-09-14' }],
    releases: [{ id: 1, title: 'Nova Versão App', description: 'Lançamento da versão 2.0', type: 'Major', status: 'Concluída', date: '2025-09-13' }],
    serviceLevels: [{ id: 1, title: 'SLA Rede', description: 'Disponibilidade de rede', target: 99, status: 'Atendido', date: '2025-09-12' }],
    financial: [{ id: 1, title: 'Compra de Servidor', description: 'Novo servidor para TI', amount: 50000, date: '2025-09-11' }],
    capacity: [{ id: 1, title: 'Relatório Mensal', description: 'Análise de servidores', utilization: 75, date: '2025-09-10' }],
    availability: [{ id: 1, title: 'Relatório Disponibilidade', description: 'Disponibilidade de sistemas', rate: 99.5, date: '2025-09-09' }],
    continuity: [{ id: 1, title: 'Plano de Backup', description: 'Plano de recuperação de desastres', status: 'Planejado', date: '2025-09-08' }]
  };

  Object.keys(dataKeys).forEach(key => {
    if (!localStorage.getItem(dataKeys[key])) {
      localStorage.setItem(dataKeys[key], JSON.stringify(defaultData[key]));
    }
  });
}

function loadTableData(key, tableId, fields, badgeField, badgeMap) {
  const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
  const tbody = document.querySelector(`#${tableId} tbody`);
  tbody.innerHTML = '';
  if (data.length === 0) {
    tbody.innerHTML = `<tr><td colspan="${fields.length + 1}" class="empty-state"><i class="fas fa-folder-open"></i><p>Nenhum registro encontrado.</p></td></tr>`;
    return;
  }
  data.forEach(item => {
    const row = document.createElement('tr');
    if (item.priority) row.classList.add(`priority-${item.priority.toLowerCase()}`);
    row.innerHTML = fields.map(field => `<td>${field === badgeField ? `<span class="badge badge-${badgeMap[item[field]] || 'open'}">${item[field] || ''}</span>` : item[field] || ''}</td>`).join('') +
      `<td class="actions">
        <button class="btn-icon btn-view" data-key="${key}" data-id="${item.id}"><i class="fas fa-eye"></i></button>
        <button class="btn-icon btn-edit" data-key="${key}" data-id="${item.id}"><i class="fas fa-edit"></i></button>
        <button class="btn-icon btn-delete" data-key="${key}" data-id="${item.id}"><i class="fas fa-trash"></i></button>
      </td>`;
    tbody.appendChild(row);
  });
  // Adicionar delegação de eventos para os botões de ação
  document.querySelectorAll(`#${tableId} .btn-icon`).forEach(button => {
    button.addEventListener('click', (e) => {
      const key = button.getAttribute('data-key');
      const id = parseInt(button.getAttribute('data-id'));
      if (button.classList.contains('btn-view')) viewItem(key, id);
      else if (button.classList.contains('btn-edit')) editItem(key, id);
      else if (button.classList.contains('btn-delete')) openDeleteModal(key, id);
    });
  });
  updateStats(key, data);
}

function updateStats(key, data) {
  if (key === 'incidents') {
    document.getElementById('open-incidents').textContent = data.filter(i => i.status === 'Pendente').length;
    document.getElementById('progress-incidents').textContent = data.filter(i => i.status === 'Em Andamento').length;
    document.getElementById('resolved-incidents').textContent = data.filter(i => i.status === 'Resolvido').length;
    document.getElementById('total-incidents').textContent = data.length;
    incidentsChart.data.datasets[0].data = [data.filter(i => i.status === 'Pendente').length, data.filter(i => i.status === 'Em Andamento').length, data.filter(i => i.status === 'Resolvido').length];
    categoriesChart.data.datasets[0].data = [
      data.filter(i => i.description.includes('Servidor')).length,
      data.filter(i => i.description.includes('Software')).length,
      data.filter(i => i.description.includes('Rede')).length,
      data.filter(i => !i.description.includes('Servidor') && !i.description.includes('Software') && !i.description.includes('Rede')).length
    ];
    incidentsChart.update();
    categoriesChart.update();
  } else if (key === 'problems') {
    document.getElementById('open-problems').textContent = data.filter(i => i.status === 'Pendente').length;
    document.getElementById('progress-problems').textContent = data.filter(i => i.status === 'Em Análise').length;
    document.getElementById('resolved-problems').textContent = data.filter(i => i.status === 'Resolvido').length;
    problemsChart.data.datasets[0].data = [data.filter(i => i.status === 'Pendente').length, data.filter(i => i.status === 'Em Análise').length, data.filter(i => i.status === 'Resolvido').length];
    problemsChart.update();
  } else if (key === 'changes') {
    document.getElementById('open-changes').textContent = data.filter(i => i.status === 'Pendente').length;
    document.getElementById('progress-changes').textContent = data.filter(i => i.status === 'Em Aprovação').length;
    document.getElementById('approved-changes').textContent = data.filter(i => i.status === 'Aprovada').length;
    changesChart.data.datasets[0].data = [data.filter(i => i.status === 'Pendente').length, data.filter(i => i.status === 'Em Aprovação').length, data.filter(i => i.status === 'Aprovada').length];
    changesChart.update();
  } else if (key === 'releases') {
    document.getElementById('planned-releases').textContent = data.filter(i => i.status === 'Planejada').length;
    document.getElementById('progress-releases').textContent = data.filter(i => i.status === 'Em Implantação').length;
    document.getElementById('completed-releases').textContent = data.filter(i => i.status === 'Concluída').length;
    releasesChart.data.datasets[0].data = [data.filter(i => i.status === 'Planejada').length, data.filter(i => i.status === 'Em Implantação').length, data.filter(i => i.status === 'Concluída').length];
    releasesChart.update();
  } else if (key === 'serviceLevels') {
    document.getElementById('active-service-levels').textContent = data.filter(i => i.status === 'Ativo').length;
    document.getElementById('breached-service-levels').textContent = data.filter(i => i.status === 'Violado').length;
    document.getElementById('met-service-levels').textContent = data.filter(i => i.status === 'Atendido').length;
    serviceLevelsChart.data.datasets[0].data = [data.filter(i => i.status === 'Ativo').length, data.filter(i => i.status === 'Violado').length, data.filter(i => i.status === 'Atendido').length];
    serviceLevelsChart.update();
  } else if (key === 'financial') {
    const total = data.reduce((sum, item) => sum + parseFloat(item.amount || 0), 0);
    document.getElementById('budget-spent').textContent = `R$ ${total.toFixed(2)}`;
    document.getElementById('budget-remaining').textContent = `R$ ${(500000 - total).toFixed(2)}`;
    financialChart.data.datasets[0].data = [
      data.filter(i => i.description.includes('Hardware')).reduce((sum, item) => sum + parseFloat(item.amount || 0), 0),
      data.filter(i => i.description.includes('Software')).reduce((sum, item) => sum + parseFloat(item.amount || 0), 0),
      data.filter(i => i.description.includes('Serviços')).reduce((sum, item) => sum + parseFloat(item.amount || 0), 0),
      data.filter(i => !i.description.includes('Hardware') && !i.description.includes('Software') && !i.description.includes('Serviços')).reduce((sum, item) => sum + parseFloat(item.amount || 0), 0)
    ];
    financialChart.update();
  } else if (key === 'capacity') {
    document.getElementById('capacity-utilization').textContent = `${Math.round(data.reduce((sum, item) => sum + parseFloat(item.utilization || 0), 0) / data.length)}%`;
    document.getElementById('capacity-issues').textContent = data.filter(i => parseFloat(i.utilization || 0) > 90).length;
    document.getElementById('capacity-optimized').textContent = data.filter(i => parseFloat(i.utilization || 0) <= 80).length;
    capacityChart.data.datasets[0].data = data.slice(-4).map(i => parseFloat(i.utilization || 0));
    capacityChart.update();
  } else if (key === 'availability') {
    document.getElementById('availability-rate').textContent = `${Math.round(data.reduce((sum, item) => sum + parseFloat(item.rate || 0), 0) / data.length * 10) / 10}%`;
    document.getElementById('availability-issues').textContent = data.filter(i => parseFloat(i.rate || 0) < 99).length;
    document.getElementById('availability-improved').textContent = data.filter(i => parseFloat(i.rate || 0) >= 99.5).length;
    availabilityChart.data.datasets[0].data = data.slice(-4).map(i => parseFloat(i.rate || 0));
    availabilityChart.update();
  } else if (key === 'continuity') {
    document.getElementById('continuity-plans').textContent = data.filter(i => i.status === 'Planejado').length;
    document.getElementById('continuity-tests').textContent = data.filter(i => i.status === 'Em Teste').length;
    document.getElementById('continuity-success').textContent = data.filter(i => i.status === 'Concluído').length;
    continuityChart.data.datasets[0].data = [data.filter(i => i.status === 'Planejado').length, data.filter(i => i.status === 'Em Teste').length, data.filter(i => i.status === 'Concluído').length];
    continuityChart.update();
  }
}

function viewItem(key, id) {
  const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
  const item = data.find(i => i.id === id);
  if (!item) return;
  const modal = document.getElementById(`${key}-modal`);
  if (!modal) {
    console.error(`Modal ${key}-modal não encontrado`);
    return;
  }
  Object.keys(item).forEach(field => {
    const element = modal.querySelector(`#modal-${key}-${field}`);
    if (element) element.textContent = item[field] || '';
  });
  modal.style.display = 'flex';
}

function editItem(key, id) {
  const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
  const item = data.find(i => i.id === id);
  if (!item) return;
  const form = document.getElementById(`${key}-form`);
  if (!form) {
    console.error(`Form ${key}-form não encontrado`);
    return;
  }
  Object.keys(item).forEach(field => {
    const input = form.querySelector(`#${key}-${field}`);
    if (input) input.value = item[field] || '';
  });
  form.onsubmit = (e) => {
    e.preventDefault();
    const updatedItem = { id };
    const inputs = form.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
      updatedItem[input.id.replace(`${key}-`, '')] = input.value;
    });
    updatedItem.date = new Date().toISOString().split('T')[0];
    if (key === 'incidents') updatedItem.user = document.getElementById('username')?.textContent || 'Usuário Desconhecido';
    const index = data.findIndex(i => i.id === id);
    if (index !== -1) {
      data[index] = updatedItem;
      localStorage.setItem(dataKeys[key], JSON.stringify(data));
      loadTableData(key, `${key}-table`, Object.keys(item), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
        Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
      });
      form.reset();
      form.onsubmit = null;
      closeModal(`${key}-form-modal`); // Fecha o modal de edição, se existir
    }
  };
}

function openDeleteModal(key, id) {
  const modal = document.getElementById(`delete-${key}-modal`);
  if (!modal) {
    console.error(`Modal delete-${key}-modal não encontrado`);
    return;
  }
  document.getElementById(`delete-${key}-id`).textContent = id;
  modal.style.display = 'flex';
  window.currentDelete = { key, id };
}

function confirmDeleteItem(key) {
  const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
  const newData = data.filter(i => i.id !== window.currentDelete.id);
  localStorage.setItem(dataKeys[key], JSON.stringify(newData));
  loadTableData(key, `${key}-table`, Object.keys(data[0] || {}), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
    Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
  });
  closeModal(`delete-${key}-modal`);
}

const confirmDeleteFunctions = {
  incidents: confirmDeleteItem,
  problems: confirmDeleteItem,
  changes: confirmDeleteItem,
  releases: confirmDeleteItem,
  serviceLevels: confirmDeleteItem,
  financial: confirmDeleteItem,
  capacity: confirmDeleteItem,
  availability: confirmDeleteItem,
  continuity: confirmDeleteItem
};

function confirmDeleteIncident() { confirmDeleteFunctions.incidents('incidents'); }
function confirmDeleteProblem() { confirmDeleteFunctions.problems('problems'); }
function confirmDeleteChange() { confirmDeleteFunctions.changes('changes'); }
function confirmDeleteRelease() { confirmDeleteFunctions.releases('releases'); }
function confirmDeleteServiceLevel() { confirmDeleteFunctions.serviceLevels('serviceLevels'); }
function confirmDeleteFinancial() { confirmDeleteFunctions.financial('financial'); }
function confirmDeleteCapacity() { confirmDeleteFunctions.capacity('capacity'); }
function confirmDeleteAvailability() { confirmDeleteFunctions.availability('availability'); }
function confirmDeleteContinuity() { confirmDeleteFunctions.continuity('continuity'); }

function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'none';
}

// Form Submissions
function handleFormSubmit(key, defaultStatus) {
  const form = document.getElementById(`${key}-form`);
  if (!form) return;
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
    const newItem = { id: data.length ? Math.max(...data.map(i => i.id)) + 1 : 1 };
    const inputs = form.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
      newItem[input.id.replace(`${key}-`, '')] = input.value;
    });
    newItem.date = new Date().toISOString().split('T')[0];
    if (key === 'incidents') newItem.user = document.getElementById('username')?.textContent || 'Usuário Desconhecido';
    if (!newItem.status && defaultStatus) newItem.status = defaultStatus;
    data.push(newItem);
    localStorage.setItem(dataKeys[key], JSON.stringify(data));
    loadTableData(key, `${key}-table`, Object.keys(newItem), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
      Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
    });
    form.reset();
    closeModal(`${key}-form-modal`); // Fecha o modal de criação, se existir
  });
}

handleFormSubmit('incidents', 'Pendente');
handleFormSubmit('problems', 'Pendente');
handleFormSubmit('changes', 'Pendente');
handleFormSubmit('releases', 'Planejada');
handleFormSubmit('serviceLevels', 'Ativo');
handleFormSubmit('financial');
handleFormSubmit('capacity');
handleFormSubmit('availability');
handleFormSubmit('continuity');

// Refresh Functions
function refreshData(key) {
  loadTableData(key, `${key}-table`, Object.keys(JSON.parse(localStorage.getItem(dataKeys[key]) || '[]')[0] || {}), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
    Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
  });
}

function refreshIncidents() { refreshData('incidents'); }
function refreshProblems() { refreshData('problems'); }
function refreshChanges() { refreshData('changes'); }
function refreshReleases() { refreshData('releases'); }
function refreshServiceLevels() { refreshData('serviceLevels'); }
function refreshFinancial() { refreshData('financial'); }
function refreshCapacity() { refreshData('capacity'); }
function refreshAvailability() { refreshData('availability'); }
function refreshContinuity() { refreshData('continuity'); }

// Search Functionality
document.querySelectorAll('[id^="search-"]').forEach(input => {
  input.addEventListener('input', (e) => {
    const key = input.id.replace('search-', '');
    const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
    const filtered = data.filter(item => 
      item.title.toLowerCase().includes(e.target.value.toLowerCase()) ||
      (item.description && item.description.toLowerCase().includes(e.target.value.toLowerCase()))
    );
    loadTableData(key, `${key}-table`, Object.keys(data[0] || {}), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
      Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
    });
  });
});

// Filter Functionality
document.querySelectorAll('.filter-select, .filter-input').forEach(input => {
  input.addEventListener('change', () => {
    const filtersCard = input.closest('.filters-card');
    const key = filtersCard.closest('.tab-content').id;
    const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
    let filtered = data;
    const status = document.getElementById('filter-status')?.value;
    const priority = document.getElementById('filter-priority')?.value;
    const date = document.getElementById('filter-date')?.value;
    if (status) filtered = filtered.filter(item => item.status === status);
    if (priority) filtered = filtered.filter(item => item.priority === priority);
    if (date) filtered = filtered.filter(item => item.date === date);
    loadTableData(key, `${key}-table`, Object.keys(data[0] || {}), key === 'incidents' ? 'status' : key === 'problems' ? 'status' : key === 'changes' ? 'status' : key === 'releases' ? 'status' : key === 'serviceLevels' ? 'status' : key === 'continuity' ? 'status' : null, {
      Pendente: 'open', 'Em Andamento': 'progress', Resolvido: 'resolved', Aprovada: 'approved', 'Em Aprovação': 'pending', Planejada: 'planned', 'Em Implantação': 'progress', Concluída: 'completed', Ativo: 'open', Violado: 'rejected', Atendido: 'completed', 'Em Análise': 'progress', 'Em Teste': 'progress', Concluído: 'completed'
    });
  });
});

// Chart Filters
document.querySelectorAll('.chart-filter').forEach(filter => {
  filter.addEventListener('change', (e) => {
    const key = filter.id.replace('-chart-filter', '');
    const chart = eval(`${key}Chart`);
    const value = e.target.value;
    const data = JSON.parse(localStorage.getItem(dataKeys[key]) || '[]');
    let filtered = data;
    if (value === 'week') {
      filtered = data.filter(item => new Date(item.date) >= new Date(new Date().setDate(new Date().getDate() - 7)));
    } else if (value === 'month') {
      filtered = data.filter(item => new Date(item.date) >= new Date(new Date().setMonth(new Date().getMonth() - 1)));
    } else if (value === 'quarter') {
      filtered = data.filter(item => new Date(item.date) >= new Date(new Date().setMonth(new Date().getMonth() - 3)));
    }
    updateStats(key, filtered);
  });
});

// Logout Function
function logout() {
  window.location.href = 'login.html';
}

// Initialize
initializeData();
initializeCharts();
refreshIncidents();
refreshProblems();
refreshChanges();
refreshReleases();
refreshServiceLevels();
refreshFinancial();
refreshCapacity();
refreshAvailability();
refreshContinuity();

// Adicionar delegação de eventos global para tabelas
document.addEventListener('click', (e) => {
  const button = e.target.closest('.btn-icon');
  if (!button) return;
  const key = button.getAttribute('data-key');
  const id = parseInt(button.getAttribute('data-id'));
  if (button.classList.contains('btn-view')) viewItem(key, id);
  else if (button.classList.contains('btn-edit')) editItem(key, id);
  else if (button.classList.contains('btn-delete')) openDeleteModal(key, id);
});
  </script>
</body>
</html>